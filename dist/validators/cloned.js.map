{"version":3,"file":"cloned.js","sources":["../../src/validators/cloned.js"],"sourcesContent":["// import defaultValidators from 'ember-changeset-validations/validators';\n// TODO custom validators must be added here and integrated\n\nimport {\n  validateDate,\n  validatePresence,\n  validateLength,\n  validateNumber,\n  validateFormat,\n  validateInclusion,\n  validateExclusion,\n  validateConfirmation,\n} from 'ember-changeset-validations/validators';\n\nimport uniqueClone from './unique-clone';\n\nconst defaultValidators = {\n  validateDate,\n  validatePresence,\n  validateLength,\n  validateNumber,\n  validateFormat,\n  validateInclusion,\n  validateExclusion,\n  validateConfirmation,\n  uniqueClone,\n};\nexport default function validateClone(options = {}) {\n  return (key, newValue, oldValue, changes, content) => {\n    var allCloneValidations = [];\n    options.validationRules = options.validationRules || [];\n    newValue = newValue || [];\n    newValue.forEach((item, index) => {\n      if (\n        (\n          (options.validationRules[0] &&\n            options.validationRules[0].activateValidation) ||\n          []\n        ).indexOf(index) < 0\n      ) {\n        allCloneValidations.push([]);\n        return;\n      }\n      var thisCloneValidations = [];\n      options.validationRules.forEach((cloneValidation) => {\n        var func;\n        if (defaultValidators[cloneValidation.validationMethod]) {\n          func = defaultValidators[cloneValidation.validationMethod](\n            cloneValidation.arguments,\n          );\n        } else {\n          func = options.customValidators[cloneValidation.validationMethod](\n            cloneValidation.arguments,\n          );\n        }\n        var validationResult = func(key, item, oldValue, changes, content);\n        if (validationResult !== true) {\n          thisCloneValidations.push(validationResult);\n        }\n      });\n      if (\n        thisCloneValidations.every((item) => {\n          return item === true;\n        })\n      ) {\n        thisCloneValidations = [];\n      }\n      allCloneValidations.push(thisCloneValidations);\n    });\n    if (\n      allCloneValidations.every((item) => {\n        return item.length === 0;\n      })\n    ) {\n      return true;\n    }\n    return { clones: allCloneValidations };\n  };\n}\n"],"names":["defaultValidators","validateDate","validatePresence","validateLength","validateNumber","validateFormat","validateInclusion","validateExclusion","validateConfirmation","uniqueClone","validateClone","options","key","newValue","oldValue","changes","content","allCloneValidations","validationRules","forEach","item","index","activateValidation","indexOf","push","thisCloneValidations","cloneValidation","func","validationMethod","arguments","customValidators","validationResult","every","length","clones"],"mappings":";;;AAAA;AACA;;AAeA,MAAMA,iBAAiB,GAAG;EACxBC,YAAY;EACZC,gBAAgB;EAChBC,cAAc;EACdC,cAAc;EACdC,cAAc;EACdC,iBAAiB;EACjBC,iBAAiB;EACjBC,oBAAoB;AACpBC,eAAAA;AACF,CAAC;AACc,SAASC,aAAaA,CAACC,OAAO,GAAG,EAAE,EAAE;EAClD,OAAO,CAACC,GAAG,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,OAAO,KAAK;IACpD,IAAIC,mBAAmB,GAAG,EAAE;AAC5BN,IAAAA,OAAO,CAACO,eAAe,GAAGP,OAAO,CAACO,eAAe,IAAI,EAAE;IACvDL,QAAQ,GAAGA,QAAQ,IAAI,EAAE;AACzBA,IAAAA,QAAQ,CAACM,OAAO,CAAC,CAACC,IAAI,EAAEC,KAAK,KAAK;MAChC,IACE,CACGV,OAAO,CAACO,eAAe,CAAC,CAAC,CAAC,IACzBP,OAAO,CAACO,eAAe,CAAC,CAAC,CAAC,CAACI,kBAAkB,IAC/C,EAAE,EACFC,OAAO,CAACF,KAAK,CAAC,GAAG,CAAC,EACpB;AACAJ,QAAAA,mBAAmB,CAACO,IAAI,CAAC,EAAE,CAAC;AAC5B,QAAA;AACF;MACA,IAAIC,oBAAoB,GAAG,EAAE;AAC7Bd,MAAAA,OAAO,CAACO,eAAe,CAACC,OAAO,CAAEO,eAAe,IAAK;AACnD,QAAA,IAAIC,IAAI;AACR,QAAA,IAAI3B,iBAAiB,CAAC0B,eAAe,CAACE,gBAAgB,CAAC,EAAE;UACvDD,IAAI,GAAG3B,iBAAiB,CAAC0B,eAAe,CAACE,gBAAgB,CAAC,CACxDF,eAAe,CAACG,SAClB,CAAC;AACH,SAAC,MAAM;AACLF,UAAAA,IAAI,GAAGhB,OAAO,CAACmB,gBAAgB,CAACJ,eAAe,CAACE,gBAAgB,CAAC,CAC/DF,eAAe,CAACG,SAClB,CAAC;AACH;AACA,QAAA,IAAIE,gBAAgB,GAAGJ,IAAI,CAACf,GAAG,EAAEQ,IAAI,EAAEN,QAAQ,EAAEC,OAAO,EAAEC,OAAO,CAAC;QAClE,IAAIe,gBAAgB,KAAK,IAAI,EAAE;AAC7BN,UAAAA,oBAAoB,CAACD,IAAI,CAACO,gBAAgB,CAAC;AAC7C;AACF,OAAC,CAAC;AACF,MAAA,IACEN,oBAAoB,CAACO,KAAK,CAAEZ,IAAI,IAAK;QACnC,OAAOA,IAAI,KAAK,IAAI;AACtB,OAAC,CAAC,EACF;AACAK,QAAAA,oBAAoB,GAAG,EAAE;AAC3B;AACAR,MAAAA,mBAAmB,CAACO,IAAI,CAACC,oBAAoB,CAAC;AAChD,KAAC,CAAC;AACF,IAAA,IACER,mBAAmB,CAACe,KAAK,CAAEZ,IAAI,IAAK;AAClC,MAAA,OAAOA,IAAI,CAACa,MAAM,KAAK,CAAC;AAC1B,KAAC,CAAC,EACF;AACA,MAAA,OAAO,IAAI;AACb;IACA,OAAO;AAAEC,MAAAA,MAAM,EAAEjB;KAAqB;GACvC;AACH;;;;"}