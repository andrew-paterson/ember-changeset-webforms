{"version":3,"file":"form-field-clone.js","sources":["../../src/utils/form-field-clone.js"],"sourcesContent":["import { tracked } from '@glimmer/tracking';\nexport default class FormFieldClone {\n  @tracked index;\n  @tracked id;\n  @tracked eventLog = [];\n  @tracked focussed;\n  @tracked changeset;\n  @tracked validatesOn = [];\n  // BEGIN-SNIPPET cloned-field-settings-tracked-props.js\n  @tracked hidden;\n  @tracked disabled;\n  @tracked externalProps;\n  // END-SNIPPET\n  constructor(args) {\n    for (const key in args) {\n      this[key] = args[key];\n    }\n  }\n\n  get fieldValue() {\n    var groupValue = this.masterFormField.fieldValue;\n    var index = this.index;\n    if (!groupValue) {\n      return null;\n    }\n    return groupValue[index];\n  }\n\n  get eventLogValidated() {\n    return this.validatesOn.filter((eventName) =>\n      this.eventLog.includes(eventName),\n    );\n  }\n\n  get validationErrors() {\n    return (\n      this.changeset.get(`error.${this.masterFormField.fieldId}.validation`) ||\n      []\n    );\n  }\n\n  get cloneValidationErrors() {\n    var index = this.index;\n    const changeset = this.changeset;\n    var validationErrors =\n      changeset.get(`error.${this.masterFormField.fieldId}.validation`) || [];\n    const cloneValidationErrors = validationErrors.find((item) => {\n      return typeof item === 'object' || item.clones;\n    });\n    if (!cloneValidationErrors) {\n      return null;\n    }\n    return cloneValidationErrors.clones[index];\n  }\n\n  get validationStatus() {\n    var clonedFormField = this;\n    if (!clonedFormField) {\n      return null;\n    }\n\n    if (\n      !clonedFormField.showValidationWhenFocussed &&\n      clonedFormField.focussed\n    ) {\n      return null;\n    }\n\n    if (!this.eventLogValidated.length) {\n      return null;\n    }\n    var clonedFieldValidationErrors = this.cloneValidationErrors || [];\n    if (clonedFieldValidationErrors.length === 0) {\n      return 'valid';\n    } else {\n      return 'invalid';\n    }\n  }\n\n  updateValidationActivation() {\n    if (this.eventLogValidated.length && this.validationRules[0]) {\n      const validationRules = this.validationRules[0];\n      validationRules.activateValidation =\n        validationRules.activateValidation || [];\n      validationRules.activateValidation.push(this.index);\n    }\n  }\n}\n"],"names":["FormFieldClone","g","prototype","tracked","i","void 0","constructor","args","key","fieldValue","groupValue","masterFormField","index","eventLogValidated","validatesOn","filter","eventName","eventLog","includes","validationErrors","changeset","get","fieldId","cloneValidationErrors","find","item","clones","validationStatus","clonedFormField","showValidationWhenFocussed","focussed","length","clonedFieldValidationErrors","updateValidationActivation","validationRules","activateValidation","push"],"mappings":"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"}