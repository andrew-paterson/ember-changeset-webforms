{"version":3,"file":"form-schema-from-query-params.js","sources":["../../src/utils/form-schema-from-query-params.js"],"sourcesContent":["import moment from 'moment';\nexport default function formSchemaFromQueryParams(\n  queryParamsObjects,\n  formName,\n) {\n  var formSchema = {\n    formSettings: {\n      formName: formName,\n      submitButtonText: 'Apply Filters',\n      clearFormButtonText: 'Reset filters',\n      showClearFormButton: true,\n      clearFormAfterSubmit: false,\n      submitAfterClear: true,\n    },\n    generalClassNames: {\n      clearFormButton: ['btn', 'btn-outline-gray-medium'],\n      submitButton: ['btn', 'btn-primary', 'cwf-form-submit-button'],\n    },\n    fields: [],\n  };\n\n  var dateRangeFieldLabels = [];\n  queryParamsObjects.forEach((item) => {\n    if (!item.filtersForm) {\n      return;\n    }\n    if (item.filtersForm.fieldType === 'dateRange') {\n      dateRangeFieldLabels.push(item.filtersForm.fieldLabel);\n      return;\n    }\n    var field = {\n      fieldId: item.key,\n      defaultValue: item.defaultValue,\n    };\n    for (var key in item.filtersForm) {\n      field[key] = item.filtersForm[key];\n    }\n    formSchema.fields.push(field);\n  });\n  dateRangeFieldLabels.uniq().forEach((label) => {\n    var objects = queryParamsObject.items.filter((item) => {\n      if (!item.filtersForm) {\n        return;\n      }\n      return item.filtersForm.fieldLabel === label;\n    });\n    var field = {\n      fieldLabel: label,\n      fieldType: 'dateRange',\n      fieldSubIds: [\n        {\n          id: '_from',\n          valueKey: 'start',\n        },\n        {\n          id: '_to',\n          valueKey: 'end',\n        },\n      ],\n      maxDate: moment().toDate(),\n      startTime: '00:01',\n      endTime: '23:59',\n    };\n    var start = objects.find((object) => {\n      return object.key.endsWith('_from');\n    });\n    var end = objects.find((object) => {\n      return object.key.endsWith('_to');\n    });\n    var startSharedKey = start.key.slice(0, start.key.lastIndexOf('_from'));\n    var endSharedKey = end.key.slice(0, end.key.lastIndexOf('_to'));\n\n    if (startSharedKey === endSharedKey) {\n      field.fieldId = startSharedKey;\n    } else {\n      throw `Your queryParams definition for ${queryParamsObject.name} has two fields set to form field type dateRange, and both have the fieldLabel ${label}. However, their keys do not correspond. They respective keys must start with the same string, followed by '_from' for the start date, and followed by '_to' for the end date.`;\n    }\n\n    field.defaultValue = {\n      start: start.defaultValue,\n      end: end.defaultValue,\n    };\n    formSchema.fields.push(field);\n  });\n  return formSchema;\n}\n"],"names":["formSchemaFromQueryParams","queryParamsObjects","formName","formSchema","formSettings","submitButtonText","clearFormButtonText","showClearFormButton","clearFormAfterSubmit","submitAfterClear","generalClassNames","clearFormButton","submitButton","fields","dateRangeFieldLabels","forEach","item","filtersForm","fieldType","push","fieldLabel","field","fieldId","key","defaultValue","uniq","label","objects","queryParamsObject","items","filter","fieldSubIds","id","valueKey","maxDate","moment","toDate","startTime","endTime","start","find","object","endsWith","end","startSharedKey","slice","lastIndexOf","endSharedKey","name"],"mappings":"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"}