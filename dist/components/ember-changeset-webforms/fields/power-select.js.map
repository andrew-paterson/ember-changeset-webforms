{"version":3,"file":"power-select.js","sources":["../../../../src/components/ember-changeset-webforms/fields/power-select.js"],"sourcesContent":["import { action } from '@ember/object';\nimport Component from '@glimmer/component';\nimport { typeOf as emberTypeOf } from '@ember/utils';\nimport PowerSelectComponent from 'ember-power-select/components/power-select';\nimport PowerSelectMultipleComponent from 'ember-power-select/components/power-select-multiple';\nimport { ensureSafeComponent } from '@embroider/util';\n\nimport 'ember-power-select/styles';\n\nexport default class PowerSelect extends Component {\n  get componentClass() {\n    return this.args.formField.multipleSelection\n      ? ensureSafeComponent(PowerSelectMultipleComponent)\n      : ensureSafeComponent(PowerSelectComponent);\n  }\n\n  @action\n  onChange(formField, value, _selectComponent, event) {\n    if ((value || []).length === 0) {\n      value = null;\n    }\n    this.args.updateFieldValue(value);\n    this.args.onUserInteraction(value, 'optionSelected', event);\n  }\n\n  @action\n  onKeydown(formField, dropdown, event) {\n    const primitiveOptions = dropdown.options.map((option) => {\n      if (\n        emberTypeOf(option) === 'object' &&\n        this.args.formField.optionDisplayProp\n      ) {\n        return option[this.args.formField.optionDisplayProp];\n      } else {\n        return option;\n      }\n    });\n    if (event.keyCode === 13) {\n      event.preventDefault();\n      if (\n        formField.multipleSelection &&\n        formField.allowFreeTyping &&\n        !primitiveOptions.find(\n          (primitiveOption) =>\n            primitiveOption\n              .toLowerCase()\n              .indexOf(event.target.value.toLowerCase()) > -1,\n        )\n      ) {\n        let value = this.fieldValue || [];\n        var newItem;\n        if (this.args.formField.optionDisplayProp) {\n          newItem = {};\n          newItem[this.args.formField.optionDisplayProp] = event.target.value;\n        } else {\n          newItem = event.target.value;\n        }\n        value.push(newItem);\n        this.args.onUserInteraction(\n          'keyDownEnterPowerSelectMultiple',\n          newItem,\n          event,\n        );\n        this.args.updateFieldValue(value, 'keyDownPowerSelect', event);\n      }\n      this.args.onUserInteraction('keyDownPowerSelect', newItem, event);\n    }\n  }\n}\n"],"names":["PowerSelect","Component","componentClass","args","formField","multipleSelection","ensureSafeComponent","PowerSelectMultipleComponent","PowerSelectComponent","onChange","value","_selectComponent","event","length","updateFieldValue","onUserInteraction","n","prototype","action","onKeydown","dropdown","primitiveOptions","options","map","option","emberTypeOf","optionDisplayProp","keyCode","preventDefault","allowFreeTyping","find","primitiveOption","toLowerCase","indexOf","target","fieldValue","newItem","push","setComponentTemplate","TEMPLATE"],"mappings":";;;;;;;;;;;;;AASe,MAAMA,WAAW,SAASC,SAAS,CAAC;EACjD,IAAIC,cAAcA,GAAG;AACnB,IAAA,OAAO,IAAI,CAACC,IAAI,CAACC,SAAS,CAACC,iBAAiB,GACxCC,mBAAmB,CAACC,4BAA4B,CAAC,GACjDD,mBAAmB,CAACE,oBAAoB,CAAC;AAC/C;EAGAC,QAAQA,CAACL,SAAS,EAAEM,KAAK,EAAEC,gBAAgB,EAAEC,KAAK,EAAE;IAClD,IAAI,CAACF,KAAK,IAAI,EAAE,EAAEG,MAAM,KAAK,CAAC,EAAE;AAC9BH,MAAAA,KAAK,GAAG,IAAI;AACd;AACA,IAAA,IAAI,CAACP,IAAI,CAACW,gBAAgB,CAACJ,KAAK,CAAC;IACjC,IAAI,CAACP,IAAI,CAACY,iBAAiB,CAACL,KAAK,EAAE,gBAAgB,EAAEE,KAAK,CAAC;AAC7D;AAAC,EAAA;IAAAI,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,UAAA,EAAA,CAPAC,MAAM,CAAA,CAAA;AAAA;AAUPC,EAAAA,SAASA,CAACf,SAAS,EAAEgB,QAAQ,EAAER,KAAK,EAAE;IACpC,MAAMS,gBAAgB,GAAGD,QAAQ,CAACE,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAK;AACxD,MAAA,IACEC,MAAW,CAACD,MAAM,CAAC,KAAK,QAAQ,IAChC,IAAI,CAACrB,IAAI,CAACC,SAAS,CAACsB,iBAAiB,EACrC;QACA,OAAOF,MAAM,CAAC,IAAI,CAACrB,IAAI,CAACC,SAAS,CAACsB,iBAAiB,CAAC;AACtD,OAAC,MAAM;AACL,QAAA,OAAOF,MAAM;AACf;AACF,KAAC,CAAC;AACF,IAAA,IAAIZ,KAAK,CAACe,OAAO,KAAK,EAAE,EAAE;MACxBf,KAAK,CAACgB,cAAc,EAAE;AACtB,MAAA,IACExB,SAAS,CAACC,iBAAiB,IAC3BD,SAAS,CAACyB,eAAe,IACzB,CAACR,gBAAgB,CAACS,IAAI,CACnBC,eAAe,IACdA,eAAe,CACZC,WAAW,EAAE,CACbC,OAAO,CAACrB,KAAK,CAACsB,MAAM,CAACxB,KAAK,CAACsB,WAAW,EAAE,CAAC,GAAG,EACnD,CAAC,EACD;AACA,QAAA,IAAItB,KAAK,GAAG,IAAI,CAACyB,UAAU,IAAI,EAAE;AACjC,QAAA,IAAIC,OAAO;AACX,QAAA,IAAI,IAAI,CAACjC,IAAI,CAACC,SAAS,CAACsB,iBAAiB,EAAE;UACzCU,OAAO,GAAG,EAAE;AACZA,UAAAA,OAAO,CAAC,IAAI,CAACjC,IAAI,CAACC,SAAS,CAACsB,iBAAiB,CAAC,GAAGd,KAAK,CAACsB,MAAM,CAACxB,KAAK;AACrE,SAAC,MAAM;AACL0B,UAAAA,OAAO,GAAGxB,KAAK,CAACsB,MAAM,CAACxB,KAAK;AAC9B;AACAA,QAAAA,KAAK,CAAC2B,IAAI,CAACD,OAAO,CAAC;QACnB,IAAI,CAACjC,IAAI,CAACY,iBAAiB,CACzB,iCAAiC,EACjCqB,OAAO,EACPxB,KACF,CAAC;QACD,IAAI,CAACT,IAAI,CAACW,gBAAgB,CAACJ,KAAK,EAAE,oBAAoB,EAAEE,KAAK,CAAC;AAChE;MACA,IAAI,CAACT,IAAI,CAACY,iBAAiB,CAAC,oBAAoB,EAAEqB,OAAO,EAAExB,KAAK,CAAC;AACnE;AACF;AAAC,EAAA;IAAAI,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,WAAA,EAAA,CA1CAC,MAAM,CAAA,CAAA;AAAA;AA2CT;AAACoB,oBAAA,CAAAC,QAAA,EA3DoBvC,WAAW,CAAA;;;;"}