{"version":3,"file":"validating-field.js","sources":["../../../../src/components/ember-changeset-webforms/field-elements/validating-field.js"],"sourcesContent":["import { action } from '@ember/object';\nimport Component from '@glimmer/component';\n\nexport default class ValidatingField extends Component {\n  get typeClass() {\n    var myStr = this.args.formField.fieldType;\n    myStr = myStr.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n    return `field-type-${myStr}`;\n  }\n\n  get labelId() {\n    return `${this.args.formField.name}-label`;\n  }\n\n  get ariaLabelledBy() {\n    if (!this.args.formField.hideLabel) {\n      return this.labelId;\n    }\n    return null;\n  }\n\n  get ariaLabel() {\n    return this.args.formField.hideLabel\n      ? this.args.formField.fieldLabel\n      : null;\n  }\n\n  get ariaErrorMessage() {\n    return (this.args.formField.validationErrors || []).length\n      ? `${this.args.formField.id}-errors`\n      : null;\n  }\n\n  get ariaDescribedBy() {\n    return this.args.formField.fieldDescription\n      ? `${this.args.formField.id}-description`\n      : null;\n  }\n\n  get isGroup() {\n    return this.args.formField.options ? true : null;\n  }\n\n  @action\n  didInsert() {\n    var formField = this.args.formField;\n    const changeset = this.args.changesetWebform.changeset;\n    if (changeset.get(formField.propertyName)) {\n      formField.eventLog.push('insert');\n      this.validateField(formField);\n    }\n    this.args.onFieldInserted(this.args.formField);\n  }\n\n  @action\n  validateField(formField) {\n    formField\n      .validate()\n      .then((fieldValidationErrors) => {\n        this.args.afterFieldValidation(\n          formField,\n          formField.changeset,\n          fieldValidationErrors,\n        );\n      })\n      .catch((err) => console.log(err));\n  }\n\n  @action\n  onUserInteraction(eventName, value, event) {\n    const formField = this.args.formField;\n\n    if (this.isDestroyed || this.isDestroying || formField.disabled) {\n      return;\n    }\n    formField.eventLog.push(eventName);\n    this.validateField(formField);\n    this.args.onUserInteraction(formField, eventName, value, event);\n  }\n\n  @action\n  updateFieldValue(value) {\n    if (this.isDestroyed || this.isDestroying) {\n      return;\n    }\n    const formField = this.args.formField;\n    formField.updateValue(value);\n    this.validateField(formField);\n    if (this.args.onFieldValueChange) {\n      this.args.onFieldValueChange(\n        formField,\n        this.args.changesetWebform.changeset,\n      );\n    }\n  }\n}\n"],"names":["ValidatingField","Component","typeClass","myStr","args","formField","fieldType","replace","toLowerCase","labelId","name","ariaLabelledBy","hideLabel","ariaLabel","fieldLabel","ariaErrorMessage","validationErrors","length","id","ariaDescribedBy","fieldDescription","isGroup","options","didInsert","changeset","changesetWebform","get","propertyName","eventLog","push","validateField","onFieldInserted","n","prototype","action","validate","then","fieldValidationErrors","afterFieldValidation","catch","err","console","log","onUserInteraction","eventName","value","event","isDestroyed","isDestroying","disabled","updateFieldValue","updateValue","onFieldValueChange","setComponentTemplate","TEMPLATE"],"mappings":"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"}