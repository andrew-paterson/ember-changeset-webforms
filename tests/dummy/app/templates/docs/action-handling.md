# Action handling

## submitAction

Optional. Provides `(changeset.data, changesetWebform)` as arguments.

The action you pass can either return a promise, or be a synchronous action. 

### Promise example

In the case of a promise based action, return the promise so that the `ChangesetWebform` component can fire the `saveSuccess` or `saveFail` actions where they are passed (See below). 

// TODO interactive

In this example, assume that `fetchPromise` returns a promise.

{{#docs-demo as |demo|}}
  {{#demo.example name="test.hbs"}}
    <Docs::ActionHandling::CustomSubmitActionPromise />
  {{/demo.example}}
  {{demo.snippet "forgot-password-form.js" label="Component JS" language="javascript"}}
  {{demo.snippet "custom-submit-promise.hbs" label="Template" language="htmlbars"}}
{{/docs-demo}}

### Synchronous example

Simply return after completing the synchronous operations, and the `ChnagesetWebform` component will fire the `saveSuccess` action if the operation runs successfully.

If an error is encountered, the `saveFail` action will be fired. TODO test this.

```javascript
submitAction(changesetData, changesetWebform) {
  this.set('prop', changesetData.email);
  return;
}
```

If `submitAction` is not passed, the fallback submit below code will run.

```javascript
changeset.save().then(saveChangesetResponse => {
  changesetWebform.formSettings.set('requestInFlight', false);
  if (this.saveSuccess) {
    this.saveSuccess(saveChangesetResponse, changesetWebform);
  }
  if (changesetWebform.formSettings.resetAfterSubmit) {
    this.send('resetForm');
  }
}).catch(error => {
  if (this.saveFail) {
    this.saveFail(error, changesetWebform);
  }
  changesetWebform.formSettings.set('requestInFlight', false);
});
```

## beforeSubmitAction

Provides `(changesetWebform)` as the only argument. Runs after a user initiates form submission, but before `castAllowedFields` and `submitAction`.

## afterGenerateChangesetWebform 

When the `ChangesetWebform` component is inserted, it calls the util that generates the parses the formSchema and generates an Ember object containing the form field sand settings. Immediately after doing so, it fires this action, providing the `changesetWebform` object as the only argument. The object contains the following properties.

```
{
  fields: // Array of Ember objects, one for each field in the formSchema.
  changeset: // The changeset generated byt he component.
  formSettings: An Ember generated by merging the form specific settings with the global form settings and addon default form settings.
  formSchema: //A copy of the original POJO form schema passed to the  `ChangesetWebform` component.
}
```

This action can be useful for accessing the above properties outside of the form itself. You can then manipulate the form UI and run validations when the user interacts with UI elements outside of the form. The example below validates the name nad email field when the user clicks "Next", which is not a part of the `ChangesetWebform` component.

<Docs::ActionHandling::AfterGenerateChangesetWebformForm />

## afterFieldValidation

Fires every time a field is validated.

It provides `(formField, ChangesetWebform, fieldValidationErrors)` as arguments.

Where there are validation errors, the value of the `fieldValidationErrors` argument takes the form of:

```
{
  value: // value of the changeset prop when validated,
  validation: [ // Array of the validation error messages ]
}
```

<Docs::ActionHandling::AfterFieldValidationForm />




--------

## afterFieldEdit

Fires every time a property in the changeset is updated.

It provides `(formField, ChangesetWebform, snapshot)` as arguments.

<!-- TODO explain snapshot -->

<Docs::ActionHandling::AfterFieldEditForm />



## afterFieldValidation (From field)

afterFieldValidation(fieldValidationErrors, formField, changeset) {



## afterFieldClick

Fires after any individual field calls the `onClick` action in the `ValidatingField` component. 

The `clicker` is the only default field which calls this action.

It provides `(formField, changesetWebform)` as arguments.

<Docs::ActionHandling::AfterFieldClickForm />

## afterInputFocusOut

It provides `(formField, changesetWebform)` as arguments.
## afterInputFocusIn

It provides `(formField, changesetWebform)` as arguments.
## afterInputKeyUp

It provides `(formField, changesetWebform, value, event)` as arguments.
<!-- ## afterOrRemoveAddClone

afterOrRemoveAddClone(clone, master, changeset) { -->

## beforeSubmitAction

beforeSubmitAction() {

## beforeValidation

beforeValidation(field) {

## customValidations

customValidations(field) {

## formValidationFailed

formValidationFailed() {

## formValidationPassed

formValidationPassed() {

## saveFail

saveFail(error, formFields, formSettings, changeset) {

## saveSuccess

saveSuccess(response, formFields, formMetaData, changeset) {